service: sa-dashboard-graphql

configValidationMode: off

frameworkVersion: "3"

provider:
  name: azure
  runtime: nodejs14
  stage: ${opt:stage, 'development'}
  resourceGroup: lc-tech-elsie
  region: East Asia
  os: linux  
  environment:
    STAGE: "${opt:stage, self:provider.stage}"

custom:
  webpack:
    webpackConfig: ./webpack.config.js
    includeModules:
      forceInclude:
        - knex
        - mysql2
    packager: "yarn"

functions:
  graphql:
    handler: src/graphql/server.graphqlServer
    events:
      - http: true
        x-azure-settings:
          name: req
          methods: ["get", "post"]
          authLevel: anonymous
      - http: true
        x-azure-settings:
          name: $return
          direction: out

plugins:
  - serverless-azure-functions
  - serverless-webpack
